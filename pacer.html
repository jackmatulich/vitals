<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="pacer.css">


    </head>
<body>

<h1>My First JavaScript</h1>

<canvas id="ecg" width="2500" height="200"></canvas>

<div>
    <h2>Rate    <span id="Rate"></span></h2>
   
    <button onclick="Rplus()">+5</button>
    <button onclick="Rminus()">-5</button>


</div>


<div>
    <h2>Atria Output    <span id="Aoutput"></span></h2>
    
    <button onclick="Aoplus()">+1</button>
    <button onclick="Aominus()">-1</button>

</div>
<div>
    <h2>Ventricular Output  <span id="Voutput"></span></h2>
    
    <button onclick="Voplus()">+1</button>
    <button onclick="Vominus()">-1</button>

</div>

<div>
    <h2>Atria Sensitivity   <span id="Asense"></span></h2>
    
    <button onclick="Asplus()">+1</button>
    <button onclick="Asminus()">-1</button>

</div>

<div>
    <h2>Ventricular Sensitivity <span id="Vsense"></span></h2>
    
    <button onclick="Vsplus()">+1</button>
    <button onclick="Vsminus()">-1</button>
</div>

<script>
let Rate = 70; 
let Ao = 0; 
let As = 0; 
let Vo = 0; 
let Vs = 0; 
document.getElementById("Rate").textContent = Rate; 
document.getElementById("Aoutput").textContent = Ao; 
document.getElementById("Asense").textContent = As; 
document.getElementById("Voutput").textContent = Vo; 
document.getElementById("Vsense").textContent = Vs; 

function Rplus() { 
     Rate=Rate+5; 
     document.getElementById("Rate").textContent = Rate; 

 } 
 function Rminus() { 
    Rate=Rate-5; 
     document.getElementById("Rate").textContent = Rate; 

 } 


 function Aoplus() { 
     Ao++; 
     document.getElementById("Aoutput").textContent = Ao; 

 } 
 function Aominus() { 
     Ao--; 
     document.getElementById("Aoutput").textContent = Ao; 
 } 

 function Asplus() { 
     As++; 
     document.getElementById("Asense").textContent = As; 
 } 
 function Asminus() { 
     As--; 
     document.getElementById("Asense").textContent = As; 
 } 
 function Voplus() { 
     Vo++; 
     document.getElementById("Voutput").textContent = Vo; 
 } 
 function Vominus() { 
     Vo--; 
     document.getElementById("Voutput").textContent = Vo; 
 } 

 function Vsplus() { 
     Vs++; 
     document.getElementById("Vsense").textContent = Vs; 
 } 
 function Vsminus() { 
     Vs--; 
     document.getElementById("Vsense").textContent = Vs; 
 } 

 var speed = 1;

 var EcgData=["0,3,6,9,12,15,18,21,24,27,30,31,33,33,34,36,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,97,98,99,100,99,98,97,96,95,94,93,92,91,90,89,88,87,86,85,84,83,82,81,80,79,78,75,76,77,78,76,75,60,50,40,30,25,15,10,5,0"];


var ecgarr = EcgData[0].split(',');


beatlength=ecgarr.length;
console.log("ecgbeatwlength:");
console.log(beatlength);
var liminal=(2500/(40/10))-beatlength;
console.log("liminal:");
console.log(liminal);
var baseline = Array.from({length: beatlength}, () => Math.floor(Math.random() * 5));
var displayrhythm = ecgarr.concat(baseline);

var canvas = document.getElementById("ecg");
    var ctx = ecg.getContext("2d");
    var w = ecg.width,
    h = ecg.height,
    speed = 2,
    scanBarWidth = 20,
    i=0,
    data = displayrhythm,
    color='#00ff00';
    var px = 0;
    var opx = 0;
    var py = h/2; /* should equal 50 if height 100px */ 
    var opy = py; /* should equal 50 if height 100px */ 
    ctx.strokeStyle = color;
    ctx.lineWidth = 5;
    ctx.setTransform(1,0,0,-1,0,h);
drawWave();

    function drawWave() {
      
      
      beatlength=ecgarr.length+(Math.floor(Math.random() * 5));
      liminal=(2500/(rate/10))-beatlength;
      console.log("rate:");
      console.log(rate);
      baseline = Array.from({length: beatlength}, () => Math.floor(Math.random() * 5));
      displayrhythm = ecgarr.concat(baseline);

      data = displayrhythm;


       px += speed;  /* adds the value to the right to the variable on the left px(0)+speed (1)=0 */ 
            ctx.clearRect( px,0, scanBarWidth, h);/* (x coord of upper left, y coord of upper left, width in px, heigh in px) */ 
            ctx.beginPath();/* starts the line OR resets */ 
            ctx.moveTo( opx,  opy);/* moves point to XY */ 
            ctx.lineJoin= 'round';/* rounds the join */ 
            py=(data[++i>=data.length? i=0 : i++])/1+30; /* and */ 
            ctx.lineTo(px, py);/* and */ 
            ctx.stroke();/* and */ 
             opx = px;/* and */ 
            opy = py;/* and */ 
            if (opx > w) {px = opx = -speed;}/* and */ 


             requestAnimationFrame(drawWave);/* and */ 
    }
</script>


</body>
</html> 

