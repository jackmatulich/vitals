<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="pacer.css">


    </head>
<body>

<h1>My First JavaScript</h1>

<canvas id="ecg" width="2500" height="200"></canvas>

<div>
    <h2>Rate    <span id="Rate"></span></h2>
   
    <button onclick="Rplus()">+5</button>
    <button onclick="Rminus()">-5</button>


</div>


<div>
    <h2>Atria Output    <span id="Aoutput"></span></h2>
    
    <button onclick="Aoplus()">+1</button>
    <button onclick="Aominus()">-1</button>

</div>
<div>
    <h2>Ventricular Output  <span id="Voutput"></span></h2>
    
    <button onclick="Voplus()">+1</button>
    <button onclick="Vominus()">-1</button>

</div>

<div>
    <h2>Atria Sensitivity   <span id="Asense"></span></h2>
    
    <button onclick="Asplus()">+1</button>
    <button onclick="Asminus()">-1</button>

</div>

<div>
    <h2>Ventricular Sensitivity <span id="Vsense"></span></h2>
    
    <button onclick="Vsplus()">+1</button>
    <button onclick="Vsminus()">-1</button>
</div>

<script>
let Rate = 70; 
let rate=30;
let Ao = 0; 
let As = 0; 
let Vo = 0; 
let Vs = 0; 
let PACE=false;
document.getElementById("Rate").textContent = Rate; 
document.getElementById("Aoutput").textContent = Ao; 
document.getElementById("Asense").textContent = As; 
document.getElementById("Voutput").textContent = Vo; 
document.getElementById("Vsense").textContent = Vs; 

function Rplus() { 
     Rate=Rate+5; 
     document.getElementById("Rate").textContent = Rate; 

 } 
 function Rminus() { 
    Rate=Rate-5; 
     document.getElementById("Rate").textContent = Rate; 

 } 


 function Aoplus() { 
     Ao++; 
     document.getElementById("Aoutput").textContent = Ao; 

 } 
 function Aominus() { 
     Ao--; 
     document.getElementById("Aoutput").textContent = Ao; 
 } 

 function Asplus() { 
     As++; 
     document.getElementById("Asense").textContent = As; 
 } 
 function Asminus() { 
     As--; 
     document.getElementById("Asense").textContent = As; 
 } 
 function Voplus() { 
     Vo++; 
     document.getElementById("Voutput").textContent = Vo; 
 } 
 function Vominus() { 
     Vo--; 
     document.getElementById("Voutput").textContent = Vo; 
 } 

 function Vsplus() { 
     Vs++; 
     document.getElementById("Vsense").textContent = Vs; 
 } 
 function Vsminus() { 
     Vs--; 
     document.getElementById("Vsense").textContent = Vs; 
 } 

 var speed = 1;

 var EcgData=["1,2,4,5,7,9,11,14,17,21,23,25,27,28,29,30,29,28,27,26,25,23,21,19,14,11,8,6,4,3,2,1,0,0,1,1,1,0,0,0,1,1,1,1,2,2,1,1,0,0,0,0,1,2,3,6,7,8,9,10,12,14,16,19,22,25,30,35,40,60,80,100,5,4,3,1,-3,-7,-10,-13,-15,-11,-5,-2,0,0,0,1,1,2,2,2,1,1,0,0,0,0,1,1,1,1,2,2,2,3,3,3,2,2,3,3,3,3,4,6,8,10,14,17,20,23,26,29,31,33,35,37,39,40,41,41,41,42,42,42,41,41,41,40,40,40,39,39,39,38,38,36,34,32,30,27,24,21,18,15,13,13,9,9,5,5,5,3,2,1"];


var ecgarr = EcgData[0].split(',');


beatlength=ecgarr.length;
console.log("ecgbeatwlength:");
console.log(beatlength);
var liminal=(2500/(rate/10))-beatlength;
console.log("liminal:");
console.log(liminal);
var baseline = Array.from({length: beatlength}, () => Math.floor(Math.random() * 5));
var displayrhythm = ecgarr.concat(baseline);

var canvas = document.getElementById("ecg");
    var ctx = ecg.getContext("2d");
    var w = ecg.width,
    h = ecg.height,
    speed = 2,
    scanBarWidth = 20,
    i=0,
    data = displayrhythm,
    color='#00ff00';
    var px = 0;
    var opx = 0;
    var py = h/2; /* should equal 50 if height 100px */ 
    var opy = py; /* should equal 50 if height 100px */ 
    ctx.strokeStyle = color;
    ctx.lineWidth = 3;
    ctx.setTransform(1,0,0,-1,0,h);
    counter=0;
    counterval=250;

    
drawWave();

    function drawWave() {
      
    

       px += speed;  /* adds the value to the right to the variable on the left px(0)+speed (1)=0 */ 
            ctx.clearRect( px,0, scanBarWidth, h);/* (x coord of upper left, y coord of upper left, width in px, heigh in px) */ 
            ctx.beginPath();/* starts the line OR resets */ 
            ctx.moveTo( opx,  opy);/* moves point to XY */ 
            ctx.lineJoin= 'round';/* rounds the join */ 
            counter=++counter>=counterval? counter=0 : counter++;
            py=(data[++i>=data.length? i=0 : i++])/1+30; /* and */ 
            
            if(counter=counterval){p2=100}else{p2=py};
            
            ctx.lineTo(px, p2);/* and */ 
            ctx.stroke();/* and */ 
             opx = px;/* and */ 
            opy = py;/* and */ 
            if (opx > w) {px = opx = -speed;}/* and */ 


             requestAnimationFrame(drawWave);/* and */ 
    }
</script>


</body>
</html> 

